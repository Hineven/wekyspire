# 魏启乱斗游戏手册
这是一个使用Vite构建，基于Vue 3框架，使用Javascript和HTML的单人肉鸽文字冒险型网页小游戏。玩家将扮演一个灵御（能使用魏启这种神奇能量的战士），随着游戏进行，不断击败越来越强大的敌人，并在每场战斗后收集金钱、获得技能、升级能力、恢复状态、购买物品、触发随机事件等，最终击败游戏的最强Boss之一。
## 主要流程
一场游戏有一些基本属性：
* 战斗场次数：总共发生过的战斗次，用于递增下一场战斗的难度。同时在场次数目达到5、10、15时，下一场战斗必然为boss战。

游戏胜利条件为玩家完成第15场战斗，游戏的主要流程有两部分：
### 战斗
战斗是游戏的主要内容，玩家和随机生成的敌人进行回合制战斗。每回合，玩家先行动，敌人后行动。
#### 战斗的规则
* 玩家和敌人共同拥有一些属性；
    * 生命值
    * 生命值上限（玩家默认为40）
    * 攻击力：描述普通型技能的威力（玩家默认为3）
    * 灵能强度：描述施法型技能的威力（玩家默认为3）
    * 防御力：描述角色的防御力，用于固定减免敌人造成的伤害（玩家默认为0）
    * 护盾值：描述角色的护盾值，用于优先代替生命值承受伤害
    * 效果层数：一个字符串到标量的词典，用于描述各个效果的层数。层数可以是负数。具体的各种效果在后文有详细列出。
* 玩家角色额外拥有一些属性：
    * 魏启（类似于法力，下文将直接称其为魏启）：部分技能的施法资源，不自动回复。
    * 魏启上限：最大存储的魏启值。
    * 行动力：施放技能固定消耗1行动力。
    * 行动力上限：最大存储的行动力值。每回合开始时，将行动力重置为此值。（玩家默认为4）
    * 等阶：描述玩家的等阶，用于限制技能的等级以及影响奖励的发放，在后文会有详细描述。
    * 技能数上限：玩家技能数的上限，默认为5。
    * 技能列表：包含玩家的所有技能，玩家最多拥有技能数上限个技能，在后文会有详细说明。
* 攻击结算：玩家和敌人可以发起对对方的攻击，玩家通过发动技能发起攻击，敌人则直接根据行动逻辑发起攻击，触发攻击结算，依次计算攻击力与灵能强度、效果层数和护盾值的影响，将攻击威力转化为伤害。
* 受伤结算：玩家和敌人可以受到伤害。受伤时，触发受伤结算，依次计算防御力、效果层数和护盾值的影响，将伤害转化为生命值与护盾值的扣减。
* 在玩家行动时，玩家可以通过点击，消耗行动力和魏启，发动技能。技能所需的行动力固定为1，魏启则可以是任意值。行动力和魏启不足时无法发动技能。每个技能每回合都有发动次数上限（默认为1），本回合此技能剩余发动次数归零时也无法发动。
* 战斗结束条件：任何时候，任意一方生命值先降到0或以下时，战斗结束。如果玩家生命降到0以下，游戏结束，玩家失败。
#### 战斗的生成
根据战斗场次，每场战斗的敌人在多种敌人模板中随机挑选，并将战斗强度输入此敌人模板来生成一定强度的敌人。
* 战斗强度：根据战斗场次数计算。默认为战斗场次数。
* 敌人模板：根据战斗强度，从多种敌人模板中随机挑选。敌人模板分为几个类型：
    * 普通型敌人：普通的敌人，较大概率出现。
    * 强敌：较强的敌人，较小概率出现。
    * Boss型敌人：Boss比其它敌人都更强大。在场次为5、10、15时的战斗必然为Boss战。Boss型敌人在在其它场次的战斗中不出现。
* 每个敌人都根据其模板有固定的行动逻辑，这会在下文详细介绍。 
#### 效果
玩家和敌人在战斗中能获得一些效果。效果分为增益、减益、中性三种。在战斗中，每个效果只需一个标量描述其层数。层数可以是负数。层数为零时代表无效果，此效果不会触发。
效果能为角色提供各种属性修正，或在回合开始/回合结束/发动技能/发动攻击/敌人受伤/受到攻击/受到伤害时发生结算，以下是所有效果（按触发时机分类，并按优先级从前往后排序）：
##### 状态修正类效果
* 防御：提升层数点防御力。
* 集中：提升层数点灵能。
* 力量：提升层数点攻击力。
* 坚固：提升层数点防御力。
* 机枪升温：指示物效果。
##### 回合开始时触发的效果
* 吸收：回合结束时，获得层数点魏启。
* 漏气：回合结束时，失去层数点魏启。
* 眩晕：回合开始时，层数减1，结束回合。
##### 回合结束时触发的效果
* 中毒：回合结束时，受到层数点真实伤害，层数减1。
* 再生：回合结束时，获得层数点生命，层数减1。
* 超然：回合结束时，增加层数层集中。
* 侵蚀：回合结束时，减少层数层集中。
* 燃心：回合结束时，增加1层集中，层数减1。
* 成长：回合结束时，增加层数层力量。
* 衰败：回合结束时，减少层数层力量。
* 巩固：回合结束时，增加层数层坚固。
* 崩溃：回合结束时，减少层数层坚固。
* 魏宗圣体：回合结束时，增加层数层集中、力量、坚固。
* 解体：回合结束时，减少层数层集中、力量、坚固。
##### 发动技能时触发的效果
* 连发：发动技能后，获得1行动力，层数减1。
##### 发动攻击时触发的效果
* 超频：攻击结算后，有10%概率双倍伤害。
##### 敌人受伤时触发的效果
* 灼烧：敌人受伤后，敌人有15%概率获得1层燃烧。
##### 受到攻击时触发的效果
* 格挡：攻击结算发生后，将伤害值减半，层数减1。
* 闪避：攻击结算发生后，将伤害减少到0。
##### 受到伤害时触发的效果
* 暴怒：受到伤害后，增加层数层力量。
* 执着：受到伤害后，增加层数层集中。
#### 技能
技能是玩家的战斗手段。玩家最多持有8个技能。
每个技能有以下属性：
* 名称：技能的名称，用于在游戏中标识技能。
* 类型：技能的类型，分为普通型和施法型。
* 等阶：技能的等阶。玩家无法获得超越其等阶的等阶的技能。
* 描述：一个函数，返回技能的详细描述文本。
* 魏启消耗：技能消耗的魏启量，默认为0。
* 回合最大施放次数：技能每回合的最大施放次数，默认为1。
* 回合剩余施放次数：技能每回合的剩余施放次数，回合开始时，重置为回合最大施放次数。
* 发动效果：一个函数，用于描述技能的发动效果，在技能发动时执行。
### 休整
在战斗后，会根据游戏进程、战斗难度、战斗内容，程式化地为玩家发放奖励，并给予玩家养成的机会。
奖励分为几种：
* 金钱：固定发生，玩家获得随机量金钱。
* 技能：固定发生，玩家可以从在三个技能中选择一个，增加到技能组里。如果技能数超过玩家技能数上限，玩家需要丢弃一个现有技能进行替换。
* 能力：奇数次战斗后发生，玩家可以在三个能力卡片中选择一个，从而提升其能力。能力卡片会在后文中详细描述。

玩家完成奖励领取后，进入休整的第二阶段：养成。此时，商店页面开启，玩家能使用金钱购买各类物品，包括状态恢复、技能升级等。

最后，玩家离开商店后，有可能触发随机事件或固定事件，此时，玩家进入对话，对话结束后，生成并开始下一轮战斗。事件会在后文中详细描述。
#### 等阶
玩家和技能的等阶分为-1、0、1、2、3、4、5、6、7、8、9共11个等级，其中，玩家等阶只可能是其中的0、2、3、5、7、8、9七个等级。
##### 玩家等阶
* 0：见习灵御。
* 2：普通灵御。
* 3：中级灵御。
* 5：高级灵御。
* 7：准大师灵御。
* 8：大师灵御。
* 9: 传奇灵御。
##### 技能等阶
* -1：特殊技能。
* 0：D级。
* 1：C-级。
* 2：C+级别。
* 3：B-级。
* 4：B级。
* 5：B+级。
* 6：A-级。
* 7：A级。
* 8：A+级。
* 9：S级。
## 敌人（模板）图鉴
### 普通
#### 史莱姆
* 生命值：15 + 5 * 战斗强度
* 攻击力：1 + 战斗强度
* 防御力：1
* 灵能强度：战斗强度 + 1
##### 行动逻辑
反复执行以下序列：
* 攻击，造成【3+攻击力】伤害。
* 攻击，造成【2 * 攻击力】伤害。
* 防御，获得【2 + 灵能强度】护盾。
#### 瑞米
* 生命值：20 + 5 * 战斗强度
* 攻击力：1 + 战斗强度
* 防御力：1
* 灵能强度：战斗强度 + 1
##### 行动逻辑
反复执行以下序列：
* 攻击，造成【6 + 攻击力】伤害。
* 获得1层闪避。
* 吃你的钱包，造成【3】伤害，玩家失去10金钱。
* 获得1层闪避。
### 精英
#### 雪狼
* 生命值：20 + 10 * 战斗强度
* 攻击力：2 + 2 * 战斗强度
* 防御力：1 + 战斗强度
* 灵能强度：1 + 战斗强度
##### 行动逻辑
反复执行以下序列：
* 攻击，造成【6 + 攻击力】伤害。
* 获得4层格挡。
* 攻击，造成【6 + 攻击力】伤害。
* 攻击，造成2次【6 + 攻击力】伤害。
* 攻击，造成【12 + 2 * 攻击力】伤害。
### Boss
#### MEFM-3
* 生命值：50 + 5 * 战斗强度
* 攻击力：5 + 1 * 战斗强度
* 防御力：1 + 战斗强度
* 灵能强度：0
##### 行动逻辑
先进行以下准备：
* 获得1层高燃弹药效果。
然后反复执行以下序列：
* 扫射攻击，造成【2 + 机枪升温层数】次【1 + 攻击力】伤害。
* 扫射攻击，造成【3 + 机枪升温层数】次【1 + 攻击力】伤害。
* 发动能量耦合，获得1层机枪升温，获得2层加固。

特殊的，如果在回合开始时，生命值首次低于50%，则在回合结束前额外进行以下操作：
* 电子故障，获得1层眩晕。
## 技能图鉴
### D级
#### 拳打脚踢
造成【1+攻击力】伤害。
* 特殊：每回合发动次数不限。
* 可升级为：功夫
#### 打滚
获得【1+灵能】护盾。
#### 睡觉
恢复【10】生命值。
* 特殊：此技能每场战斗只能使用一次。
### C-级
#### 功夫
造成【2+1.5*攻击力】伤害。
* 特殊：每回合发动次数不限。
## 能力图鉴
在战斗结束后，有时，玩家能从随机抽取的三张能力卡中选一张实现，提升自己的能力。其中可能包含：
#### 突破
提升玩家等阶到下一等阶，获得10魏启上限，能获得和使用更高级的技能，并且行动力上限增1。
#### 强化
玩家攻击力、防御力、灵能各增1。
#### 成长
攻击力增1，生命值增20。
#### 修炼
灵能增1，获得7魏启上限，恢复所有魏启。
## 事件图鉴
#### 开场事件
* 固定事件，在游戏开始时触发。

艾纳：你好呀，小灵御。

艾纳：我负责接引你，看到你的技能了吗？快打败那只史莱姆练练手吧！

#### Boss MEFM-3战前事件
* 固定事件，在与MEFM-3战斗前触发。

MEFM-3：嗡嗡嗡...检测到未识别的生命体，开始清理。

#### 占位随机事件
* 随机事件，每场战斗后有20%概率触发。

艾纳：你好呀，小灵御，我又来拉！

然后随即播报以下对话之一：

艾纳：一个超位的存在将我带到了这里。他告诉我，我们都在一场游戏中，而这个游戏似乎实际上还没开发好。

艾纳：哎呀，你认识Hineven吗？他让我随便找你聊点什么，我也不知道该聊点什么了~好吧，就这样吧！

## 商品
玩家在商店中可以购买商品。一个商品在一次商店购物中只能购买一次。商品包括：
* 能力：150金钱，从3个随机能力中选择一个。
* 恢复生命：13金钱，获得40生命。
* 恢复魏启：13金钱，获得40魏启。
* 技能位：80金钱，获得额外技能数上限增1。
* 技能升级：40金钱，选择一个现有技能，将其替换为其下一个等级的技能。

# 魏启乱斗开发手册
## UI
此游戏主要依赖文字、按钮和少量图片与少量简单动画效果呈现游戏内容。

UI包含四个基础界面：开始游戏界面、战斗界面、休整界面、结束界面。

UI还包含额外的一个悬浮于所有界面上的特殊界面：对话界面。

### 开始游戏界面
游戏开始时的界面，包含游戏标题、开始游戏按钮。
### 战斗界面
在战斗时呈现的界面，包含四个面板：
#### 敌人面板
敌人面板在顶部呈现玩家的状态，包含名称、生命条以及一个效果栏组件，描述敌人身上的所有效果。
#### 战斗日志面板
战斗日志在界面中央，以条为单位用文字记录战斗中发生过的事情，可以上下滚动，新事件发生时自动滚动到底部。
#### 玩家面板
底部的玩家面板呈现玩家的状态，包含名称、生命条、魏启条、行动力点数栏、其他数值状态、以及一个效果栏组件，描述玩家身上的所有效果。
#### 操作面板
最底部的操作面板呈现玩家的技能，并提供操作按钮。技能以卡片按钮的形式排成一行呈现，在面板最下方有结束回合按钮。

技能卡片上呈现技能名称、技能描述。如果技能因为发动次数用完或其它原因导致无法发动时，卡片为灰色。如果技能有超过1的剩余发动次数，显示在卡片底部。技能的等阶以彩色字母显示在卡片右上角。
### 休整界面
战斗后，玩家进入休整界面，开始休整流程，一系列面板会按规则呈现以供玩家进行操作。

总体而言，面板的呈现为：
* 先呈现奖励面板。
* 奖励面板关闭后，呈现商店面板。
* 商店面板关闭后，退出休整界面，进入事件播放或下一场战斗。
#### 奖励面板
战斗结束后，奖励面板将直接出现，分栏按钮描述玩家在战斗后获得的奖励，比如金钱、能力等，点击按钮即可领取此项奖励。其中一些按钮点击后会进入其它面板来更细致地选择奖励进行领取。

奖励面板底部包含一个结束按钮，点按后，奖励面板退出，商店面板打开。
#### 能力奖励面板
在玩家点击能力奖励按钮后跳出，呈现从能力牌库中随机抽选的至多三张不同能力卡，玩家点击后，领取此能力并关闭此面板。此面板额外包含一个放弃按钮，玩家点击后，直接退出面板并放弃能力奖励。
#### 技能奖励面板
在玩家点击技能奖励按钮后跳出，呈现从玩家目前等阶可获得技能堆内随机抽选的至多三个不同技能，玩家点击后，领取此技能并关闭此面板。此面板额外包含一个放弃按钮，玩家点击后，直接退出面板并放弃技能奖励。

如果玩家地技能数目已经达到上限，则开启技能选取面板，面板中选中的技能将被替换为新技能。
#### 技能选取面板
呈现一系列技能（默认为玩家持有的所有技能），玩家能且必须点选其中一个技能，完成后此面板关闭。
#### 商店面板
商店面板内包含一系列卡片，每个卡片描述一个商品，玩家点击卡片后，如果金钱充足，则玩家购买并消耗商品。

特殊的，在购买能力和技能升级时，打开能力奖励/技能选取面板选择要获得的能力/要升级的技能。

商店面板底部包含一个结束按钮，点按后，商店面板退出，进入事件播放或下一场战斗。
### 对话界面
对话界面是一个类似Galgame设计的特殊界面，悬浮于所有界面之上，用于播放事件对话。

对话界面包含一个对话文本框用于显示对话内容，一个头像框用于显示对话者的头像。点击屏幕上任意一点都可以继续播放对话。

在没有在事件中时，对话界面隐藏。

### 结束界面
在游戏结束时（玩家死亡，或玩家战胜了第15场战斗后的Boss后）显示，包含游戏结束文字、重新开始按钮。